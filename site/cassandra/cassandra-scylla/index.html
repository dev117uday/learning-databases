<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  
  <link rel="shortcut icon" href="../../img/favicon.ico">
  <title>Cassandra : Scylla - Learning Datbases</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700" />

  <link rel="stylesheet" href="../../css/theme.css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css" />
  
  <script>
    // Current page data
    var mkdocs_page_name = "Cassandra : Scylla";
    var mkdocs_page_input_path = "cassandra/cassandra-scylla.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../../js/jquery-2.1.1.min.js" defer></script>
  <script src="../../js/modernizr-2.8.3.min.js" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
        <a href="../.." class="icon icon-home"> Learning Datbases</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../..">Table of contents</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Cassandra</span></p>
                <ul class="current">
                    <li class="toctree-l1 current"><a class="reference internal current" href="./">Cassandra : Scylla</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#setup-docker">Setup : Docker</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#replication-factor">Replication Factor</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#consistency-level">Consistency Level</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#sharding-in-scylla-db">Sharding in Scylla DB</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#other-important-concepts">Other Important Concepts</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#partition-key">Partition Key</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#node">Node</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#cluster">Cluster</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#table">Table</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#keyspace">Keyspace</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#cql">CQL</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#cql-shell">CQL Shell</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#replication">Replication</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#consistency-level_1">Consistency Level</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#tunable-consistency">Tunable Consistency</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#replication-factor_1">Replication Factor</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#cap-theorem">CAP Theorem</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#token-ranges">Token Ranges</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#gossips">Gossips</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#cluster-level-readwrite-interaction">Cluster Level Read/Write Interaction</a>
    </li>
    </ul>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../cql/">CQL</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../data-modelling/">Data Modelling</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Mongodb</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../mongodb/mongo-administration/">Mongo Administration</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../mongodb/mongodb-aggregation/">MongoDB Aggregation</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../mongodb/mongodb/">MongoDB</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../mongodb/mql/">MQL</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Redis</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../redis/redis/">Redis</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Sql</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../sql/order-of-sql-execution/">Order of SQL Execution</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="#">Advance tables</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../sql/advance-tables/internals/">Advance Tables</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../sql/advance-tables/managing-tables/">Managing Tables</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../sql/advance-tables/paritioning-tables/">Partitioning Tables</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../sql/advance-tables/pivotal-or-crosstab-tables/">Pivotal or Crosstab Tables</a>
                </li>
    </ul>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="#">Data types</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../sql/data-types/">Data Types</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../sql/data-types/arrays/">Arrays</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../sql/data-types/date-time-stamps/">Date/Time/Stamps</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../sql/data-types/json/">JSON</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../sql/data-types/miscellaneous-1/">Internal Functions</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../sql/data-types/sequences/">Sequences</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../sql/data-types/user-defined-data-types/">User Defined Data Types</a>
                </li>
    </ul>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="#">Functions</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../sql/functions/">Functions</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../sql/functions/cursors/">Cursors</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../sql/functions/pl-pgsql/">PL/PGSQL</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../sql/functions/stored-procedures/">Stored Procedures</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="#">Triggers</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../sql/functions/triggers/">Triggers</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../sql/functions/triggers/more-on-triggers/">More on Triggers</a>
                </li>
    </ul>
                </li>
    </ul>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="#">Getting started</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../sql/getting-started/">Getting Started</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../sql/getting-started/administration-task/">PgAdmin Tool</a>
                </li>
    </ul>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="#">Indexing</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../sql/indexing/">Indexing</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../sql/indexing/custom-indexes/">Custom Indexes</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../sql/indexing/gin-index/">GIN Index</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../sql/indexing/indexes/">Indexes</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../sql/indexing/sql/">SQL</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../sql/indexing/unique-index/">Unique Index</a>
                </li>
    </ul>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="#">Joins</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../sql/joins/cross-join/">Cross & Natural Joins</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../sql/joins/full-multiple-and-self-joins/">Full, Multiple & Self Joins</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../sql/joins/inner-join/">Inner Join</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../sql/joins/left-and-right-join/">Left and Right JOIN</a>
                </li>
    </ul>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="#">Summarization</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../sql/summarization/">Summarization</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../sql/summarization/subqueries/">SubQueries</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../sql/summarization/window/">Window</a>
                </li>
    </ul>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="#">Tables</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../sql/tables/">Table</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../sql/tables/aggregation/">Aggregation</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../sql/tables/coalesce/">Usefull Functions</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../sql/tables/combining-tables/">Combining Tables</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../sql/tables/constraints/">Constraints</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../sql/tables/cte/">Common Table Expression</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../sql/tables/group-by-and-having/">GROUP BY and HAVING</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../sql/tables/miscellaneous/">OPERATORS</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../sql/tables/order-by/">ORDER BY and DISTINCT</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../sql/tables/views/">Views</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../sql/tables/where/">WHERE Clause</a>
                </li>
    </ul>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="#">Working with database</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../sql/working-with-database/">Database</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../sql/working-with-database/schema/">Schema</a>
                </li>
    </ul>
                    </li>
                </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../..">Learning Datbases</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">Docs</a> &raquo;</li>
    
      
        
          <li>Cassandra &raquo;</li>
        
      
    
    <li>Cassandra : Scylla</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  
  <hr/>
</div>

          <div role="main">
            <div class="section">
              
                <h1 id="cassandra-scylla">Cassandra : Scylla</h1>
<h3 id="setup-docker">Setup : Docker</h3>
<pre><code class="language-bash">sudo docker run --name scyllaTest -d scylladb/scylla
sudo docker exec -it scyllaTest nodetool status
sudo docker exec -it scyllaTest cqlsh
</code></pre>
<p>Scylla runs nodes in a hash ring. All nodes are equal:</p>
<ul>
<li>there are no master</li>
<li>slave</li>
<li>replica sets.</li>
</ul>
<h3 id="replication-factor">Replication Factor</h3>
<p>The Replication Factor (RF) is equivalent to the number of nodes where data (rows and partitions) are replicated. Data is replicated to multiple (RF=N) nodes. An RF of one means there is only one copy of a row in a cluster, and there is no way to recover the data if the node is compromised or goes down. RF=2 means that there are two copies of a row in a cluster. An RF of at least three is used in most systems</p>
<h3 id="consistency-level">Consistency Level</h3>
<p>The Consistency Level (CL) determines how many replicas in a cluster must acknowledge a read or write operation before it is considered successful.</p>
<p>Some of the most common Consistency Levels used are:</p>
<ul>
<li><code>ANY</code> – A write must be written to at least one replica in the cluster. A read waits for a response from at least one replica. It provides the highest availability with the lowest consistency.</li>
<li><code>QUORUM</code> – When a majority of the replicas respond, the request is honored. If RF=3, then 2 replicas respond. QUORUM can be calculated using the formula (n/2 +1) where n is the Replication Factor.</li>
<li><code>ONE</code> – If one replica responds; the request is honored.</li>
<li><code>LOCAL_ONE</code> – At least one replica in the local data center responds.</li>
<li><code>LOCAL_QUORUM</code> – A quorum of replicas in the local datacenter responds.</li>
<li><code>EACH_QUORUM</code> – (unsupported for reads) – A quorum of replicas in ALL datacenters must be written to.</li>
<li><code>ALL</code> – A write must be written to all replicas in the cluster, a read waits for a response from all replicas. Provides the lowest availability with the highest consistency.</li>
</ul>
<h3 id="sharding-in-scylla-db">Sharding in Scylla DB</h3>
<p>Each Scylla <a href="https://university.scylladb.com/topic/node/">node</a> consists of several independent shards, which contain their share of the node’s total data. Scylla creates a one shard per core (technically, one shard per <a href="https://en.wikipedia.org/wiki/Hyper-threading">hyperthread</a>, meaning some physical cores may have two or more virtual cores). Each shard operates on a <a href="https://en.wikipedia.org/wiki/Shared-nothing_architecture">shared-nothing architecture</a> basis. This means each shard is assigned its RAM and its storage, manages its <a href="https://www.scylladb.com/2018/04/19/scylla-i-o-scheduler-3/">schedulers for the CPU and </a>I/O, performs its compaction (more about compaction later on), and maintains its multi-queue network connection. Each shard runs as a single thread, and communicates asynchronously with its peers, without locking.</p>
<h3 id="other-important-concepts">Other Important Concepts</h3>
<h4 id="partition-key">Partition Key</h4>
<p>A <strong>Partition Key</strong> is one or more columns that are responsible for data distribution across the nodes. It determines in which nodes to store a given row. As we will see later on, typically, data is replicated, and copies are stored on multiple nodes. This means that even if one node goes down, the data will still be available. It ensures reliability and fault tolerance</p>
<h4 id="node">Node</h4>
<p>A Node is a unit of storage in Scylla. It is comprised of the Scylla database server software running on a computer server — a physical machine — and all its subsystems (CPUs, memory, storage, network interfaces and so on), or, in a visualized environment, a subset of a server’s resources assigned to a container.</p>
<h4 id="cluster">Cluster</h4>
<p>A minimum Cluster typically consists of at least 3 nodes. Data is replicated across the cluster, depending on the Replication Factor</p>
<h4 id="table">Table</h4>
<p>A Table is how Scylla stores data and can be thought of as a set of rows and columns.</p>
<h4 id="keyspace">Keyspace</h4>
<p>A Keyspace is a collection of tables with attributes that define how data is replicated on nodes. It defines several options that apply to all the tables it contains, most prominently of which is the replication strategy used by the Keyspace. It is generally encouraged to use one Keyspace per application, and thus a Cluster may define only one Keyspace.</p>
<h4 id="cql">CQL</h4>
<p>A query language for interacting with the Scylla (or Cassandra) database.</p>
<h4 id="cql-shell">CQL Shell</h4>
<p>A command-line interface for interacting with Scylla through the Cassandra Query Language (CQL)</p>
<h4 id="replication">Replication</h4>
<p>The process of replicating data across Nodes in a Cluster.</p>
<h4 id="consistency-level_1">Consistency Level</h4>
<p>A configurable setting which dictates how many replicas in a Cluster must acknowledge read or write operations.</p>
<h4 id="tunable-consistency">Tunable Consistency</h4>
<p>The possibility for unique, per-query, Consistency Level settings. These are incremental and override fixed database settings intended to enforce data consistency. Such settings may be set directly from a CQL statement when response speed for a given query or operation is more important.</p>
<h4 id="replication-factor_1">Replication Factor</h4>
<p>The total number of replica Nodes across a given Cluster. A Replication Factor of 1 means that the data will only exist on a single Node in the Cluster and this setup will not have any fault tolerance. The Replication Factor is set for each Keyspace. All replicas share equal priority; there are no primary or master replicas.</p>
<h4 id="cap-theorem">CAP Theorem</h4>
<p>The CAP Theorem is a concept that states that a distributed database system can only have 2 of the 3: Consistency, Availability, and Partition Tolerance.</p>
<h4 id="token-ranges">Token Ranges</h4>
<p>Each <a href="https://university.scylladb.com/topic/node/">node</a> in a ring is assigned a range. The <a href="https://en.wikipedia.org/wiki/Hash_function">hash function</a> computes a token for a given partition key. The hash function determines the placement of the data in the <a href="https://university.scylladb.com/topic/cluster-node-ring/">cluster</a>.</p>
<p>Without using <strong>Vnodes</strong> or virtual nodes, each node could only support one token range. By using vnodes, each node can support multiple, non-contiguous token ranges. By doing this, we can think of each physical node as hosting many virtual nodes. By default, each node has 256 virtual nodes.</p>
<h4 id="gossips">Gossips</h4>
<p>Scylla, like Apache Cassandra, uses a type of inter-node communication protocol called Gossip.</p>
<p>For <a href="https://university.scylladb.com/topic/node/">nodes</a> to exchange information with each other. Gossip is decentralized, and there is no single point of failure. It’s used for peer node discovery and metadata propagation. Gossip communication occurs periodically. Each node communicates with three other nodes. Eventually (within a few seconds), the information is propagated throughout the <a href="https://university.scylladb.com/topic/cluster-node-ring/">cluster</a>. To see whether a node is communicating using Gossip, we use the <em><strong>statusgossip</strong></em> command:</p>
<h3 id="cluster-level-readwrite-interaction">Cluster Level Read/Write Interaction</h3>
<p>So what happens when data is read or written at the <a href="https://university.scylladb.com/topic/cluster-node-ring/">cluster</a> level? Note that what happens at the <a href="https://university.scylladb.com/topic/node/">node</a> level will be explained in another lesson.</p>
<p>Since each node is equal in Scylla, any node can receive a read/write request. These are the main steps in the process:</p>
<p><img alt="" src="https://university.scylladb.com/wp-content/uploads/2019/01/Read_Write_Cluster_Path.png" /></p>
<ol>
<li>A client connects to a Scylla node using CQL shell and performs a CQL request</li>
<li>The node the client connected to is now designated as the Coordinator Node. The Coordinator Node, based on <a href="https://en.wikipedia.org/wiki/Hash_function">hashing</a> the data, using the partition key and on the <a href="https://university.scylladb.com/topic/replication-strategy/">Replication Strategy</a>, sends the request to the applicable nodes. Inter-node messages are sent through a messaging queue in an asynchronous way.</li>
<li>The <a href="https://university.scylladb.com/topic/consistency-level-cl/">Consistency Level</a> determines the number of nodes the coordinator needs to hear back from, in order for the request to be successful.</li>
<li>The client is notified if the request was successful.</li>
</ol>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../cql/" class="btn btn-neutral float-right" title="CQL">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../.." class="btn btn-neutral" title="Table of contents"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../.." style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../cql/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script>var base_url = '../..';</script>
    <script src="../../js/theme_extra.js" defer></script>
    <script src="../../js/theme.js" defer></script>
      <script src="../../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
